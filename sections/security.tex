\section{Security}

We next prove the security of $\pedpopcomm$ with respect to the notion of security defined by $\FDKGAbort$.

\begin{theorem}
\label{thm:keygen-pedpopplus}
Assume $\NIZKUCR$ is an online-extractable zero-knowledge proof for the Schnorr
relation $\SchnorrR$.
Then, for $t \leq n/2$,
the $\pedpopcomm$ DKG is secure under aborts in the programmable random oracle model,
and realizes the idealized notion $\FDKGAbort$.
\end{theorem}

\begin{proof}
    To establish the proof of Theorem~\ref{thm:keygen-pedpopplus},
    we define a simulator $\SIM$ that is given black-box access to the static adversary $\adv$.

    \medskip

    \paragraph{\bf Setup.}
    \begin{itemize}
        \item $\SIM$ runs the adversary,
        and receives the set $\corrupt$.
        $\SIM$ then sets $\honest \gets \set{n} \setminus \corrupt$.
        $\SIM$ outputs $\corrupt$ to the functionality $\FDKGAbort$.
        \item $\SIM$ receives $\dkgchal \in \Gr$ from $\FDKGAbort$.
        \item $SIM$ initializes the table $\QSchnorr \gets \emptyset$
    \end{itemize}

    \medskip

    \paragraph{\bf Round 0.}
    To simulate the initial round of the DKG,
    $\SIM$ follows the protocol honestly for each party $i \in \honest$.
    \chelsea{Discuss how $H_1$ is simulated}

    \medskip

    \paragraph{\bf Round 1.}
    To simulate Round~1 of the DKG,
    $\SIM$ does the following:
    \begin{itemize}
    \item Derive $\sid$ honestly.
    \item  For each honest party $i \in \honest$,
    sample $H_i \rgets \Zq$.
    \item When the adversary queries party $k \in \honest$,
    output $H_k$.
    \end{itemize}

    \medskip

    \paragraph{\bf Round 2.}
    On input $\{H_i \}_{i \in \set{n}}$,
    To simulate Round~1 of the DKG,
    $\SIM$ does the following:
    \begin{itemize}
      \item For each corrupt party $j \in \corrupt$,
      look up $(\sid, j, C_j[0]) \gets \QSchnorrR[H_j]$.
      \item If any $H_j$ does not correspond to a valid entry,
      follow the remainder of Round~2 honestly for all honest participants.
      \item Otherwise, for all honest parties $i \in \honest, i \neq \simid$,
      follow Round~2 as defined in the protocol.
      \item However, for party $\simid$,
      do as follows:
    \end{itemize}

\end{proof}
